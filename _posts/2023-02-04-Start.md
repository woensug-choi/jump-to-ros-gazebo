---
title: ❑ 시작하기
author: Woen-Sug Choi
date: 2023-01-29
category: Jekyll
layout: post
---

# **◼ ROS-Gazebo 설치하기**

## 설치환경 준비
ROS와 Gazebo 모두 윈도우와 리눅스 어느 운영체제에서도 설치 가능하다. 그러나 각 프로그램이 리눅스 환경에서 개발되었다는것을 고려할 때 <span style="color: #9645FF">**리눅스 환경**</span>에 설치하는 것이 여러모로 자연스럽고 불필요한 오류를 회피할 수 있다. 따라서 ROS-Gazebo 프레임워크를 설치하기 위해서는 리눅스 환경이 필요하다. 

- <span style="color: #9645FF">**리눅스 환경 구성방법**</span>
  - **네이티브 리눅스 환경 구성 (듀얼부팅, 또는 포맷 후 리눅스만 설치)**
  - **(😎 추천!) 윈도우에 WSL<sup>✱1</sup>을 이용한 리눅스 가상환경 구성**

리눅스 환경을 구성하는 방법은 리눅스를 부팅 운영체제로써 사용하는 네이티브 방식과 윈도우 운영체제 PC에서 가상환경으로 구성하는 방법이 있다. **일반적으로 가상환경은 성능저하를 야기하나, 2016년에 등장한 윈도우 정식 WSL 가상환경을 활용하면 성능저하 없이<sup>✱2</sup> 리눅스 환경을 구성할 수 있다.** 이렇게 구성할 경우 전체적인 구동 시스템은 아래 그림과 같이 구성된다.

<div class="mermaid" style="text-align:center;"> 
%% GRAPH TYPE %%
graph LR;

%% Colors %% 
classDef blue fill:#2374f7,stroke:#000,stroke-width:2px,color:#fff
classDef pink fill:#eb3dd6,stroke:#000,stroke-width:2px,color:#fff
classDef orange fill:#fc822b,stroke:#000,stroke-width:2px,color:#fff
classDef red fill:#ed2633,stroke:#000,stroke-width:2px,color:#fff
classDef green fill:#16b522,stroke:#000,stroke-width:2px,color:#fff

%% CONTENTS %%
  oid1("Base OS (윈도우)"):::blue--가상화--oWSL:::green;
  WSL--oid1("리눅스 OS (Ubuntu)"):::orange;
  id1("리눅스(Ubuntu)"):::orange--구동-.-ROS;
  id1("리눅스(Ubuntu)"):::orange--구동-.-Gazebo;
</div>

> **<sup>✱1</sup> WSL(Windows Subsystem for Linux)**
> - 윈도우에서 네이티브로 리눅스 실행파일을 실행하기 위한 호환성 하위 계층
      - 윈도우에서 리눅스를 사용하기 위한 가상화 도구
      - 듀얼부팅 설정 불필요. 가상머신화 불필요. 빠른 속도 장점
> - 2016년에 WSL처음 등장 2019년에 WSL2 등장. Microsoft 재정기반으로 진행되고 있어서 개발속도가 매우 빠름
      - 예를들어 Ubuntu에서 [X.org](http://X.org) (그래픽 표현 시스템)을 차세대 Wayland로 21.04 버전에서 변환했고 22.04 (2022년 4월) 부터 배포했는데, WSL은 이미 2020부터 Wayland 기반
      - 개발문화도 매우 개방적이로 스타트업 분위기여서 개발자가 자기 블로그/유투브에 개발내용 공개하고 개발자들 환호하고 댓글달고 함 (이거보고 마소 주식 삼)

> <sup>✱2</sup> 파일의 읽기쓰기 성능에 제한이 있으나 계산속도에서는 네이티브와 차이가 거의 없다.

### 윈도우 WSL 환경 준비
- 윈도우 11
  - **윈도우 11부터는 WSL을 설치하기 위한 환경이 이미 구성되어 있음**
- 윈도우 10
  - 버전 2004 (빌드 19041) 이상
  - 이전 버전의 경우 [수동 설치](https://learn.microsoft.com/ko-kr/windows/wsl/install-manual)

#### WSL2 설치

윈도우 시작버튼을 오른쪽 클릭해 Windows PowerShell(관리자) 실행을 클릭, 윈도우 터미널을 관리자 모드로 실행하고 다음 명령어를 입력한 다음 컴퓨터를 다시 시작한다. 이때 WSL의 설치와 함께 리눅스 운영체제 중 하나인 Ubuntu의 22.04 버전을 함께 설치하며, 설치과정에서 Ubuntu에서 사용 할 비밀번호를 설정하게 된다.

```bash
wsl --install Ubuntu-22.04
```

재시작 후, 다시 Windows PowerShell(관리자)에서 다음 명령어를 입력해 Ubuntu 22.04를 실행하는 WSL의 버전을 2로 설정한다.

```bash
wsl --set-version Ubuntu-22.04 2
```

* WSL 설치 공식문서 (영문)
    - [Install Linux on Windows with WSL](https://learn.microsoft.com/en-us/windows/wsl/install)
* (😎 추천!) Install Windows Terminal to access Ubuntu in WSL2
    - [Windows Terminal (Microsoft Store)](https://www.microsoft.com/ko-kr/p/windows-terminal/9n0dx20hk701)


#### (필요 시) 외장그래픽 드라이버 설정

외장그래픽을 사용하면 Gazebo 시뮬레이터의 렌더링 속도 (FPS) 가 크게 향상시킬 수 있다. WSL은 Intel, AMD, NVIDIA 그래픽 드라이버를 공식 지원하고 있다. 먼저 위의 **WSL2 설치**를 통해 우분투를 설치했다면 윈도우 시작버튼을 누르고 Ubuntu를 검색해 실행시킨다. (Windows Termianl을 설치했다면 멋진 커맨드창이 뜰 것이다)

아래 명령어를 실행 해, 현재 그래픽 화면 구성 상태를 확인한다.

```bash
sudo apt update
sudo apt install -y x11-apps
xeyes
```

xeyes를 실행하면 두 눈이 보이는 창이 뜨고 마우스를 따라 갈 것이다. 이제 외장그래픽 GPU가속을 확인해보자.

```bash
sudo apt-get install -y mesa-utils
glxgears
```

맞물려가는 기어가 보일 것이다. 잘 보인다면 이미 설정이 잘 되어있는것이며 아니라면, 아래 링크를 통해 외장 그래픽 드라이버를 설치한다.

- WSL 그래픽가속을 위한 외장그래픽 드라이버
  - [NVIDIA 드라이버](https://developer.nvidia.com/cuda/wsl)
  - [AMD 드라이버](https://www.amd.com/en/support/kb/release-notes/rn-rad-win-wsl-support)
  - [Intel 드라이버](https://www.intel.com/content/www/us/en/download/19344/intel-graphics-windows-dch-drivers.html)

설치 완료 후, 재부팅하고 다시 우분투에서 아래 명령어를 입력해본다.

```bash
glxinfo | grep OpenGL
```

그러면 다음과 유사한 메세지가 뜰 것이다. 
```bash
OpenGL vendor string: Microsoft Corporation
OpenGL renderer string: D3D12 (NVIDIA GeForce GTX 1660 Ti)
```

만약, 에러가 발생한다면,
```bash
sudo add-apt-repository ppa:kisak/kisak-mesa && sudo apt-get update && sudo apt dist-upgrade
```

## ROS-Gazebo 설치

### 옵션 1. Ubuntu에 직접설치

우분투에 직접 설치하면 원하는 버전의 ROS와 Gazebo를 설치할 수 있다.

#### ROS 설치
ROS 2를 설치한다.

#### Gazebo Garden 설치
Gazebo Garden을 설치한다.

### 옵션 2. Docker로 설치

Docker를 이용하면 아주 간단히 설치할 수 있다. 그러나 설치하는 ROS와 Gazebo의 버전의 선택이 제한된다.

Docker에 대한 설명과 기초학습은 [Docker 학습]({% post_url 2023-02-06-Aux %}#docker)에 있다.